<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 7: Files, YAML & Shell | Go From Python</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="gamification.css">
</head>
<body>
    <div class="container">
        <nav>
            <a href="module6.html">‚Üê Module 6</a>
            <a href="module8.html">Module 8 ‚Üí</a>
        </nav>
        <div class="module-tag">// MODULE 07</div>
        <h1>Files, YAML & Shell</h1>
        <p class="module-desc">Read files, parse configs, run shell commands. Build a task runner from scratch.</p>

        <div class="lesson">
            <h2>Reading & Writing Files</h2>
            <div class="code-block">
                <div class="code-header">File operations</div>
                <pre><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"os"</span>
)

<span class="keyword">func</span> <span class="func">main</span>() {
    <span class="comment">// Read entire file (simple)</span>
    data, err := os.<span class="func">ReadFile</span>(<span class="string">"config.yaml"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="func">panic</span>(err)
    }
    
    <span class="comment">// Write entire file</span>
    err = os.<span class="func">WriteFile</span>(<span class="string">"output.txt"</span>, []<span class="type">byte</span>(<span class="string">"Hello!"</span>), <span class="number">0644</span>)
    
    <span class="comment">// Check if file exists</span>
    <span class="keyword">if</span> _, err := os.<span class="func">Stat</span>(<span class="string">"file.txt"</span>); os.<span class="func">IsNotExist</span>(err) {
        fmt.<span class="func">Println</span>(<span class="string">"File doesn't exist"</span>)
    }
    
    <span class="comment">// Create directory</span>
    os.<span class="func">MkdirAll</span>(<span class="string">"path/to/dir"</span>, <span class="number">0755</span>)
    
    <span class="comment">// List directory</span>
    entries, _ := os.<span class="func">ReadDir</span>(<span class="string">"."</span>)
    <span class="keyword">for</span> _, e := <span class="keyword">range</span> entries {
        fmt.<span class="func">Println</span>(e.<span class="func">Name</span>(), e.<span class="func">IsDir</span>())
    }
}</pre>
            </div>
        </div>

        <div class="lesson">
            <h2>Parsing YAML</h2>
            <div class="code-block">
                <div class="code-header terminal">Install yaml package</div>
                <pre>$ go get gopkg.in/yaml.v3</pre>
            </div>
            <div class="code-block">
                <div class="code-header yaml">tasks.yaml</div>
                <pre>name: my-project
version: "1.0"

tasks:
  build:
    command: go build -o app .
    description: Build the application
  
  test:
    command: go test ./...
    description: Run tests
  
  deploy:
    command: ./deploy.sh
    depends_on:
      - build
      - test</pre>
            </div>
            <div class="code-block">
                <div class="code-header">Parsing YAML</div>
                <pre><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
    <span class="string">"gopkg.in/yaml.v3"</span>
)

<span class="keyword">type</span> <span class="type">Config</span> <span class="keyword">struct</span> {
    Name    <span class="type">string</span>          <span class="string">`yaml:"name"`</span>
    Version <span class="type">string</span>          <span class="string">`yaml:"version"`</span>
    Tasks   <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">Task</span> <span class="string">`yaml:"tasks"`</span>
}

<span class="keyword">type</span> <span class="type">Task</span> <span class="keyword">struct</span> {
    Command     <span class="type">string</span>   <span class="string">`yaml:"command"`</span>
    Description <span class="type">string</span>   <span class="string">`yaml:"description"`</span>
    DependsOn   []<span class="type">string</span> <span class="string">`yaml:"depends_on"`</span>
}

<span class="keyword">func</span> <span class="func">main</span>() {
    data, err := os.<span class="func">ReadFile</span>(<span class="string">"tasks.yaml"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="func">panic</span>(err)
    }
    
    <span class="keyword">var</span> config <span class="type">Config</span>
    <span class="keyword">if</span> err := yaml.<span class="func">Unmarshal</span>(data, &config); err != <span class="keyword">nil</span> {
        <span class="func">panic</span>(err)
    }
    
    fmt.<span class="func">Printf</span>(<span class="string">"Project: %s v%s\n"</span>, config.Name, config.Version)
    <span class="keyword">for</span> name, task := <span class="keyword">range</span> config.Tasks {
        fmt.<span class="func">Printf</span>(<span class="string">"  %s: %s\n"</span>, name, task.Description)
    }
}</pre>
            </div>
        </div>

        <div class="lesson">
            <h2>Running Shell Commands</h2>
            <div class="code-block">
                <div class="code-header">os/exec package</div>
                <pre><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
    <span class="string">"os/exec"</span>
)

<span class="keyword">func</span> <span class="func">main</span>() {
    <span class="comment">// Simple command with output</span>
    out, err := exec.<span class="func">Command</span>(<span class="string">"ls"</span>, <span class="string">"-la"</span>).<span class="func">Output</span>()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="func">Println</span>(<span class="string">"Error:"</span>, err)
    }
    fmt.<span class="func">Println</span>(<span class="func">string</span>(out))
    
    <span class="comment">// Run through shell (for pipes, etc)</span>
    cmd := exec.<span class="func">Command</span>(<span class="string">"bash"</span>, <span class="string">"-c"</span>, <span class="string">"echo hello | tr a-z A-Z"</span>)
    out, _ = cmd.<span class="func">Output</span>()
    fmt.<span class="func">Println</span>(<span class="func">string</span>(out))  <span class="comment">// HELLO</span>
    
    <span class="comment">// Stream output in real-time</span>
    cmd = exec.<span class="func">Command</span>(<span class="string">"go"</span>, <span class="string">"build"</span>, <span class="string">"-v"</span>, <span class="string">"."</span>)
    cmd.Stdout = os.Stdout  <span class="comment">// Connect to our stdout</span>
    cmd.Stderr = os.Stderr
    err = cmd.<span class="func">Run</span>()
    
    <span class="comment">// Get exit code</span>
    <span class="keyword">if</span> exitErr, ok := err.(*exec.ExitError); ok {
        fmt.<span class="func">Println</span>(<span class="string">"Exit code:"</span>, exitErr.<span class="func">ExitCode</span>())
    }
}</pre>
            </div>
            <div class="warning">
                <div class="warning-title">Security</div>
                <p>Never pass user input directly to shell commands. Use exec.Command with separate args, not bash -c with string interpolation.</p>
            </div>
        </div>

        <div class="lesson">
            <h2>Environment Variables</h2>
            <div class="code-block">
                <div class="code-header">Working with env vars</div>
                <pre><span class="keyword">import</span> <span class="string">"os"</span>

<span class="comment">// Get env var (empty string if not set)</span>
home := os.<span class="func">Getenv</span>(<span class="string">"HOME"</span>)

<span class="comment">// Get with default</span>
port := os.<span class="func">Getenv</span>(<span class="string">"PORT"</span>)
<span class="keyword">if</span> port == <span class="string">""</span> {
    port = <span class="string">"8080"</span>
}

<span class="comment">// Check if set</span>
val, exists := os.<span class="func">LookupEnv</span>(<span class="string">"API_KEY"</span>)
<span class="keyword">if</span> !exists {
    <span class="func">panic</span>(<span class="string">"API_KEY not set"</span>)
}

<span class="comment">// Set env var</span>
os.<span class="func">Setenv</span>(<span class="string">"MY_VAR"</span>, <span class="string">"value"</span>)

<span class="comment">// Pass env to subprocess</span>
cmd := exec.<span class="func">Command</span>(<span class="string">"./script.sh"</span>)
cmd.Env = <span class="func">append</span>(os.<span class="func">Environ</span>(), <span class="string">"CUSTOM=value"</span>)</pre>
            </div>
        </div>

        <div class="project-box">
            <h3>üî® Project: Task Runner</h3>
            <p>Put your skills to work! Build a task runner that reads YAML configs and executes shell commands.</p>
            <a href="project-taskrunner.html" class="nav-btn primary">Start Project ‚Üí</a>
        </div>

        <div class="lesson">
            <h2>Module 7 Summary</h2>
            <ul>
                <li><strong>os.ReadFile / WriteFile</strong> ‚Äî simple file I/O</li>
                <li><strong>yaml.Unmarshal</strong> ‚Äî parse YAML into structs</li>
                <li><strong>exec.Command</strong> ‚Äî run external commands</li>
                <li><strong>cmd.Stdout = os.Stdout</strong> ‚Äî stream output</li>
                <li><strong>os.Getenv / LookupEnv</strong> ‚Äî environment variables</li>
            </ul>
        </div>

        <div class="nav-buttons">
            <a href="module6.html" class="nav-btn">‚Üê Module 6</a>
            <a href="module8.html" class="nav-btn primary">Module 8: Building TUIs ‚Üí</a>
        </div>
    </div>
    <script src="theme.js"></script>
    <script src="sidebar.js"></script>
    <script src="gamification.js"></script>
</body>
</html>
